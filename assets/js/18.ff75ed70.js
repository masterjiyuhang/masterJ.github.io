(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{583:function(t,s,a){"use strict";a.r(s);var n=a(13),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("坚持学习，大势所趋。")]),t._v(" "),a("h2",{attrs:{id:"切换node版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#切换node版本"}},[t._v("#")]),t._v(" 切换node版本")]),t._v(" "),a("p",[t._v("nvm控制、切换node版本")]),t._v(" "),a("p",[t._v("nvm ls")]),t._v(" "),a("p",[t._v("nvm use 12.22.1")]),t._v(" "),a("p",[t._v("nvm use 10.15.3")]),t._v(" "),a("h2",{attrs:{id:"模块规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块规范"}},[t._v("#")]),t._v(" 模块规范")]),t._v(" "),a("p",[t._v("commonjs、amd、 cmd、 umd、 ES-Module")]),t._v(" "),a("h3",{attrs:{id:"commonjs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commonjs"}},[t._v("#")]),t._v(" commonjs")]),t._v(" "),a("p",[t._v("commonjs 定义一个全局性方法require()，用于加载模块。nodejs就是基于commonJS规范的。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("var math = require('math');")])]),t._v(" "),a("li",[t._v("Module.exoprts 、exports")]),t._v(" "),a("li",[t._v("exports只是对module.exports的一个引用")]),t._v(" "),a("li",[t._v("require执行后，必须等其中的方法全部加载完成。")]),t._v(" "),a("li",[t._v("放在浏览器取决于网速的快慢，可能需要等待很长时间，浏览器处于假死状态。")])]),t._v(" "),a("h3",{attrs:{id:"amd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#amd"}},[t._v("#")]),t._v(" amd")]),t._v(" "),a("p",[t._v("amd （Asynchronous Module Definitions ） 适用于浏览器端，因RequireJS而出名。")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n　　"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n　　　a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),t._v("\n　　"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// b.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./a.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("moduleA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("moduleA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打印出：hello world")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("CommonJS是主要为了JS在后端的表现制定的，他是不适合前端的，AMD(异步模块定义)出现了，它就主要为前端JS的表现制定规范。")])]),t._v(" "),a("li",[a("p",[t._v("采用异步方式加载模块，模块的加载不影响它后面语句的运行。所有依赖这个模块的语句，都定义在一个回调函数中，等到加载完成之后，这个回调函数才会执行。")])]),t._v(" "),a("li",[a("p",[t._v("管理模块之间的依赖性，便于代码的编写和维护。")])])]),t._v(" "),a("h3",{attrs:{id:"cmd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cmd"}},[t._v("#")]),t._v(" CMD")]),t._v(" "),a("p",[t._v("CMD 是 SeaJS 在推广过程中对模块定义的规范化产出。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("在AMD基础上改进的一种规范，和AMD不同在于对依赖模块的执行时机处理不同，CMD是就近依赖，而AMD是前置依赖。")])]),t._v(" "),a("li",[a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// a.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n　　exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// b.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" moduleA "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./a.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("moduleA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打印出：hello world")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])])])]),t._v(" "),a("h3",{attrs:{id:"umd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#umd"}},[t._v("#")]),t._v(" umd")]),t._v(" "),a("ul",[a("li",[t._v("兼容AMD和commonJS规范的同时，还兼容全局引用的方式")]),t._v(" "),a("li",[t._v("UMD在使用诸如Rollup/ Webpack之类的bundler时通常用作备用模块")]),t._v(" "),a("li",[t._v("前后端均通用，写法复杂")])]),t._v(" "),a("h3",{attrs:{id:"es-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#es-module"}},[t._v("#")]),t._v(" ES Module")]),t._v(" "),a("ul",[a("li",[t._v("按需加载")]),t._v(" "),a("li",[t._v("import export 只能在模块的顶层，不能在代码之中。")]),t._v(" "),a("li",[t._v("import语句可以在代码块中实现异步动态按需加载。")])]),t._v(" "),a("h2",{attrs:{id:"vite使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vite使用"}},[t._v("#")]),t._v(" vite使用")]),t._v(" "),a("h3",{attrs:{id:"vite是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vite是什么"}},[t._v("#")]),t._v(" vite是什么？")]),t._v(" "),a("p",[t._v("一个新型前端构建工具，一个基于浏览器原生ES Modules的开发服务器，利用浏览器去解析模块，在服务器端按需编译返回，完全跳过了打包的概念。")]),t._v(" "),a("p",[t._v("Vite 目前更像是一个类似于 webpack-dev-server 的开发工具。")]),t._v(" "),a("h3",{attrs:{id:"为啥要有打包工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为啥要有打包工具"}},[t._v("#")]),t._v(" 为啥要有打包工具？")]),t._v(" "),a("p",[t._v("最初是为了解决低版本浏览器不支持ESM模块化的问题，将各个分散的JavaScript模块合并成一个文件，同时将多个JavaScript脚本合并成一个文件，减少http请求的数量，提升页面首次访问的速度。")]),t._v(" "),a("h3",{attrs:{id:"打包工具对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打包工具对比"}},[t._v("#")]),t._v(" 打包工具对比？")]),t._v(" "),a("p",[a("strong",[t._v("webpack")])]),t._v(" "),a("p",[t._v("接连引入了Loader、Plugin机制，提供了各种构建相关的能力。如Babel转译、css合并、代码压缩等。")]),t._v(" "),a("p",[a("strong",[t._v("vite")])]),t._v(" "),a("p",[t._v("针对Vue单页面组件的无打包开发服务器，可以直接在浏览器运行请求的vue文件。")]),t._v(" "),a("p",[t._v("注意他的特点是无打包，vite会启动一个本地服务器处理不同的加载需求。\n相对于地址导入，要根据后缀名处理文件内容并返回。\n对于裸模块导入需要修改他的路径为相对地址并再次请求。")]),t._v(" "),a("p",[t._v("Vite要求项目完全由ES Module模块组成，common.js模块不能直接在Vite上使用。")]),t._v(" "),a("p",[a("code",[t._v("vite")]),t._v("对比"),a("code",[t._v("webpack")])]),t._v(" "),a("p",[a("code",[t._v("webpack")]),t._v(" 打包时，需要将所有模块打包成一个一个或多个模块，最终将所有的代码打包放入一个"),a("code",[t._v("bundle.js")]),t._v("文件之中。每次修改其中一个子模块，就需要所有代码重新打包，那么随着你写的代码越来越多，重新打包的时间就会越来越长。然后就要考虑到打包优化，比如分片啊，缓存啊之类的操作就往上丢，但是如果项目接着迭代，代码更进一步增多了呢。咋办？接着优化呗？在优化也得打包不是。")]),t._v(" "),a("p",[t._v("之所以打包变慢了，是因为  webpack 会将许多资源构成一个或多个bundle，如果我们跳过打包的过程，只在需要某个模块的时候在通过请求去获取资源，会有什么意想不到的效果呢？")]),t._v(" "),a("p",[t._v("所以，新一代的构建工具出现了，由于越来越多的浏览器开始支持ES模块，越来越多的工具使用编译型语言编写。")]),t._v(" "),a("h3",{attrs:{id:"基本使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本使用"}},[t._v("#")]),t._v(" 基本使用？")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("npm init @vitejs/app")]),t._v("  ||  "),a("strong",[t._v("npm init @vitejs/app my-vue-app --template vue")])]),t._v(" "),a("li",[a("strong",[t._v("npm i @vitejs/plugin-vue-jsx -D")])])]),t._v(" "),a("h3",{attrs:{id:"vite如何实现的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vite如何实现的"}},[t._v("#")]),t._v(" vite如何实现的？")]),t._v(" "),a("p",[t._v("特点：")]),t._v(" "),a("ul",[a("li",[t._v("冷启动")]),t._v(" "),a("li",[t._v("即时热模块更新\n"),a("ul",[a("li",[t._v("背景： 随着应用体积的增长，打包启动时效率很低，更新速度直线下降。")])])]),t._v(" "),a("li",[t._v("按需编译")])]),t._v(" "),a("p",[t._v("实现：")]),t._v(" "),a("p",[t._v("请求拦截原理实现")]),t._v(" "),a("p",[t._v("启动一个 koa 服务器拦截浏览器请求ES Module的请求。")]),t._v(" "),a("ul",[a("li",[t._v("✨Vite以ESM 的方式作为模块化格式，实际上是让浏览器接管了打包程序的部分工作：\n"),a("ul",[a("li",[t._v("Vite 只需要在浏览器请求源码时进行转换并按需提供源码。")]),t._v(" "),a("li",[t._v("根据情景动态导入代码，即只在当前屏幕上实际使用时才会被处理。")])])])]),t._v(" "),a("p",[t._v("热更新实现")]),t._v(" "),a("ul",[a("li",[t._v("HMR（动态模块热重载）：允许一个模块热替换它自己，不会影响页面其余部分。Vite 只需要精确地使已编辑的模块与其最近的 HMR 边界之间的链失活。")]),t._v(" "),a("li",[t._v("Vite 同时利用 HTTP 头来加速整个页面的重新加载。\n"),a("ul",[a("li",[t._v("源码模块的请求会根据 "),a("code",[t._v("304 Not Modified")]),t._v(" 进行协商缓存，而依赖模块请求则会通过 "),a("code",[t._v("Cache-Control: max-age=31536000,immutable")]),t._v(" 进行强缓存，因此一旦被缓存它们将不需要再次请求。")])])])]),t._v(" "),a("p",[t._v("在Vite中，HMR是基于原生ESM上执行的。hot module reload")]),t._v(" "),a("ul",[a("li",[t._v("​\t在客户端与服务端之间建立了一个webscoket链接，当代码修改时，服务端发送消息通知客户端去请求修改模块的代码，完成热更新。")]),t._v(" "),a("li",[t._v("服务端原理\n"),a("ul",[a("li",[t._v("服务端做的就是监听代码文件的改变，在合适的时机向客户端发送webscoket信息去通知客户端请求新的模块代码。")])])]),t._v(" "),a("li",[t._v("客户端原理\n"),a("ul",[a("li",[t._v("Vite的 websocket 相关代码在 处理 html 中时被写入代码中。")]),t._v(" "),a("li",[t._v("当request.path 路径是 /vite/client 时，请求得到对应的客户端代码，因此在客户端中我们创建了一个 websocket 服务并与服务端建立了连接。 Vite 会接受到来自客户端的消息。通过不同的消息触发一些事件。做到浏览器端的即时热模块更换（热更新）。")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);